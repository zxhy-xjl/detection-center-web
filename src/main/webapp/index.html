<html lang="zh-CN">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<head>
<title>互联网+政务服务门户</title>
<style type='text/css'>
	body {
	     background-color: #CCC;
	}
</style>
<link rel="stylesheet" href="js/bootstrap/css/bootstrap.min.css" >
<link rel="stylesheet" href="js/bootstrap/css/bootstrap-theme.min.css" >
<link rel="stylesheet" href="js/bootstraptable/css/bootstrap-table.min.css">
<link rel="stylesheet" href="js/bootstrapselect/css/bootstrap-select.min.css">
<script src="js/jquery/js/jquery-3.2.1.min.js"></script>
<script src="js/jquery/js/jquery-rest.js"></script>
<script src="js/bootstrap/js/bootstrap.min.js"></script>
<script src="js/bootstraptable/js/tableExport.js"></script>
<script src="js/bootstraptable/js/bootstrap-table.js"></script>
<script src="js/bootstraptable/js/bootstrap-table-export.js"></script>
<script src="js/knockout/js/knockout-3.4.2.js"></script>
<script src="js/knockout/js/knockout.mapping-latest.js"></script>
<script src="js/bootstraptable/js/knockout.bootstraptable.js"></script>
<script src="js/bootstrapselect/js/bootstrap-select.min.js"></script>
<script src="js/bootstrapselect/js/i18n/defaults-zh_CN.min.js"></script>
<script src="js/bootstrapcheckbox/js/bootstrap-checkbox.min.js"></script>
<script src="js/xjl/js/xjl.js"></script>
<script src="js/xjl/js/xjl-table.js"></script>
<script src="js/xjl/js/cloud/terminalSimulator.js"></script>
<script type="text/javascript">
function testTerminalInfo(){
	var json = JSON.parse(XJL.Terminal.info());
	var msg = "";
	if (json.state=="ok"){
		msg = json.data.rcu;
	} else {
		msg = json.error.message + "("+json.error.code+")";
	}
	addItem("终端信息::" + msg,json.state=="ok");
}
function testIDCardReader(){
	var json = JSON.parse(XJL.IDCard.reader());
	var msg = "";
	if (json.state=="ok"){
		msg = json.data.name;
	} else {
		msg = json.error.message + "("+json.error.code+")";
	}
	addItem("身份证读卡器::" + msg,json.state=='ok');
}
function testSICardReader(){
	var json = JSON.parse(XJL.SICard.reader());
	var msg = "";
	if (json.state=="ok"){
		msg = json.data.no;
	} else {
		msg = json.error.message + "("+json.error.code+")";
	}
	addItem("社保卡::" + msg,json.state=="ok");
}
function testThermalPrinters(){
	var json = JSON.parse(XJL.ThermalPrinters.print());
	var msg = "";
	if (json.state=="ok"){
		//msg = json.data;
	} else {
		msg = json.error.message + "("+json.error.code+")";
	}
	addItem("小票打印机::" + msg,json.state=="ok");
}
function testHSICatch(){
	var json = JSON.parse(XJL.HSI.catch());
	var msg = "";
	if (json.state=="ok"){
		msg = json.data.photos.length;
	} else {
		msg = json.error.message + "("+json.error.code+")";
	}
	addItem("高拍仪拍照::" + msg,json.state=="ok");
}
function testA4PrintersPrintFile(){
	var json = JSON.parse(XJL.A4Printers.printFile());
	var msg = "";
	if (json.state=="ok"){
		//msg = json.data;
	} else {
		msg = json.error.message + "("+json.error.code+")";
	}
	addItem("A4打印机打印本地文件::" + msg,json.state=="ok");
}
function testCertPrintersPrintFile(){
	var json = JSON.parse(XJL.CertPrinters.printFile());
	var msg = "";
	if (json.state=="ok"){
		//msg = json.data;
	} else {
		msg = json.error.message + "("+json.error.code+")";
	}
	addItem("证照打印本地文件::" + msg,json.state=="ok");
}

function testCameraWatch(){
	var json = JSON.parse(XJL.Camera.watch());
	addItem("摄像头拍照::" + json.state,json.state=="ok");
}
function testCameraVideo(){
	var json = JSON.parse(XJL.Camera.video());
	var msg = "";
	if (json.state=="ok"){
		//msg = json.data;
	} else {
		msg = json.error.message + "("+json.error.code+")";
	}
	addItem("摄像头录像::" + msg,json.state=="ok");
}
function testAudioPlay(){
	var json = JSON.parse(XJL.Audio.play());
	var msg = "";
	if (json.state=="ok"){
		//msg = json.data;
	} else {
		msg = json.error.message + "("+json.error.code+")";
	}
	addItem("喇叭播放声音::" + msg,json.state=="ok");
}
function testBarCodeScan(){
	var json = JSON.parse(XJL.BarCode.scan());
	var msg = "";
	if (json.state=="ok"){
		msg = json.data.barcode;
	} else {
		msg = json.error.message + "("+json.error.code+")";
	}
	addItem("扫码::" + msg,json.state=="ok");
}


//排队取号机
function detectionPDQHJ(){
	addTitle("正在检测 排队取号机",4);
	cleanGroup();
	testTerminalInfo();
	testIDCardReader();
	testThermalPrinters();
	testAudioPlay();
}
//电子宣传屏
function detectionDZXCP(){
	addTitle("正在检测 电子宣传屏",2);
	cleanGroup();
	testTerminalInfo();
	testAudioPlay();
}
//大厅导航机
function detectionDTDHJ(){
	addTitle("正在检测 大厅导航机",4);
	cleanGroup();
	testTerminalInfo();
	testIDCardReader();
	testThermalPrinters();
	testAudioPlay();
	
}//自助办理终端
function detectionZZBLZD(){
	addTitle("正在检测 自助办理终端",10);
	cleanGroup();
	testTerminalInfo();
	testIDCardReader();
	testHSICatch();
	testThermalPrinters();
	testA4PrintersPrintFile();
	testCameraWatch();
	testCameraVideo();
	testAudioPlay();
	testBarCodeScan();
	testSICardReader();
}//自助打表终端
function detectionZZDBZD(){
	addTitle("正在检测 自助打表终端",5);
	cleanGroup();
	testTerminalInfo();
	testIDCardReader();
	testA4PrintersPrintFile();
	testCameraWatch();
	testAudioPlay();
	
}//自助取证终端
function detectionZZQZZD(){
	addTitle("正在检测 自助取证终端",6);
	cleanGroup();
	testTerminalInfo();
	testIDCardReader();
	testA4PrintersPrintFile();
	testCameraWatch();
	testAudioPlay();
	testCertPrintersPrintFile();
}
//总检测数量
var itemCount;
//当前是第几个检测
var itemNow;
//成功的检测数量
var itemSuccess;
function cleanGroup(){
	$("#detectionContentGroup").empty();
}
function addTitle(title,count){
	$("#detectionContentTitle").text(title);
	itemCount = count;
	itemNow = 0;
	itemSuccess = 0;
	showProgressbar();
}
function addItem(item,state){
	setTimeout(function(){
		if (state){
			itemSuccess++;
		}
		if (state){
			$("#detectionContentGroup").append($('<li class="list-group-item"><span class="badge">OK</span>'+item+'</li>'));
			
		} else {
			$("#detectionContentGroup").append($('<li class="list-group-item list-group-item-danger"><span class="badge" style="color:red">&nbsp;&nbsp;X&nbsp;&nbsp;</span>'+item+'</li>'));
			
		}
		showProgressbar();
	},2000*(++itemNow));

}
function showProgressbar(){
	console.log("显示进度条:",itemNow);
	var value = (itemSuccess/itemCount).toFixed(2)*100;
	$("#progressbar").attr("aria-valuenow",value);
	$("#progressbar").attr("style","width: "+value+"%");
	$("#progressbar").empty();
	$("#progressbar").append($("<span>"+value+"% Complete (success)</span>"));
}
</script>
</head>
<body>
<nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <img class="navbar-brand" src="images/xjl.png" height="30px">
      <label class="navbar-brand">云检测中心</label>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li class="active"><a href="#">出厂检测 <span class="sr-only">(current)</span></a></li>
        <li><a href="#">故障诊断</a></li>
        <li><a href="#">使用帮助</a></li>
      </ul>
      
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>
<div class="container">
	<div class="row">
	  <div class="col-xs-6 col-md-2">
	    <a href="#" class="thumbnail" onclick="detectionPDQHJ()">
	       排队取号机
	    </a>
	  </div>
	  <div class="col-xs-6 col-md-2">
	    <a href="#" class="thumbnail" onclick="detectionDZXCP()">
	      电子宣传屏
	    </a>
	  </div>
	  <div class="col-xs-6 col-md-2">
	    <a href="#" class="thumbnail" onclick="detectionDTDHJ()">
	      大厅导航机
		</a>
	  </div>
	  <div class="col-xs-6 col-md-2">
	    <a href="#" class="thumbnail" onclick="detectionZZBLZD()">
	      自助办理终端
	    </a>
	  </div>
	  <div class="col-xs-6 col-md-2">
	    <a href="#" class="thumbnail" onclick="detectionZZDBZD()">
	      自助打表终端
	    </a>
	  </div>
	  <div class="col-xs-6 col-md-2">
	    <a href="#" class="thumbnail" onclick="detectionZZQZZD()">
	      自助取证终端
	    </a>
	  </div>
	</div>
	<div id="detectionContent">
		<div class="panel panel-default">
		  <div class="panel-heading" id="detectionContentTitle"></div>
		  <div class="panel-body">
		  	<div class="progress">
			  <div id="progressbar" class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%">
			    <span>0% Complete (success)</span>
			  </div>
			</div>
		  </div>
	       <ul class="list-group" id="detectionContentGroup">
			  
			</ul>
		</div>
	</div>
</div>
</body>
</html>
